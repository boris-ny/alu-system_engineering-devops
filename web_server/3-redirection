#!/usr/bin/env bash

# Install Nginx
sudo apt update
sudo apt install nginx -y

# Create a file for the server block configuration
sudo touch /etc/nginx/sites-available/redirect.conf

# Write the server block configuration to the file
cat << EOF | sudo tee /etc/nginx/sites-available/redirect.conf
server {
    listen 80;
    server_name _;

    # Redirect /redirect_me to another page with 301 status code
    location = /redirect_me {
        return 301 https://www.example.com/new_page;
    }

    # Serve other requests normally
    location / {
        root /usr/share/nginx/html;
        index index.html index.htm;
    }
}
EOF

# Enable the server block by creating a symbolic link to sites-enabled directory
sudo ln -s /etc/nginx/sites-available/redirect.conf /etc/nginx/sites-enabled/

# Disable the default server block by removing the symbolic link from sites-enabled directory
sudo rm /etc/nginx/sites-enabled/default

# Test the Nginx configuration for syntax errors
sudo nginx -t

# Reload Nginx to apply the changes
sudo systemctl reload nginx